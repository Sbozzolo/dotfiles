#!/bin/bash

# Check if internet is up and when I updated Arch, if more than N days propose to update

N=1

last=`cat /var/log/pacman.log | grep "Syu" | awk 'END{ print substr($1,2); print substr($2, 1, length($2)-1) }'`
# Last update in seconds
epochlast=`date -d "$last" +%s`

# Starting from newdate this script shoud ask for update
newdate=$(($epochlast + $N*86400))

now=`date +%s`

if [ "$now" -gt "$newdate" ]; then
    if ping -c 1 8.8.8.8 >> /dev/null 2>&1; then
        echo "Running Pacman -Syu"
        sudo pacman -Syu
        echo "Running Pacaur -Syu"
        pacaur -Syu
    else
        exit
    fi
fi
